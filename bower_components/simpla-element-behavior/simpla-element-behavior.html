<html><head><script>"use strict";function _defineProperty(b,c,d){return c in b?Object.defineProperty(b,c,{value:d,enumerable:!0,configurable:!0,writable:!0}):b[c]=d,b}var _extends=Object.assign||function(b){for(var c,a=1;a<arguments.length;a++)for(var d in c=arguments[a],c)Object.prototype.hasOwnProperty.call(c,d)&&(b[d]=c[d]);return b},DEFAULT_CONFIG={getCallback:"_updateFromSimpla",setCallback:"_updateSimplaBuffer"},ERRORS={NO_SIMPLA:"Cannot find Simpla, ensure it is included before this component"};window.SimplaBehaviors=window.SimplaBehaviors||{},SimplaBehaviors.Element=function(b){var c=_extends({},DEFAULT_CONFIG,b),d=c.type,f=c.getCallback,g=c.setCallback,h=c.dataProperties;return{properties:{path:{type:String,observer:"_initPathIfReady"},editable:{type:Boolean,observer:"_disableEditableIfReadonly",notify:!0},readonly:{type:Boolean,observer:"_updateReadonly"},loaded:{type:Boolean,readOnly:!0,notify:!0,value:!1},__simplaObservers:{type:Object,value:function(){return{}}}},observers:h.map(function(a){return"_syncedPropertiesObserver("+a+".*)"}),created:function(){if(!window.Simpla)throw new Error(ERRORS.NO_SIMPLA)},attached:function(){this._attached=!0,this.editable=!this.readonly&&(this.editable||Simpla.getState("editable")),this._observeSimplaEditable(),this._initPathIfReady(this.path)},detached:function(){var a=this;Object.keys(this.__simplaObservers).forEach(function(b){a.__simplaObservers[b].unobserve()}),this.__simplaObservers={}},_initPathIfReady:function(a){this._attached&&void 0!==a&&this._initSimplaPath(a)},_updateReadonly:function(a){this.editable=!a&&Simpla.getState("editable")},_disableEditableIfReadonly:function(a){this.readonly&&a&&(this.editable=!1)},_initSimplaPath:function(b){var c=this;this._setLoaded(!1),Simpla.get(b).then(function(d){var a=!(d&&d.data),e=c.path!==b,f=Simpla.getState("buffer"),g=f&&f[b]&&!f[b].modified;e||(a&&g?c._protectedSetCallback():c._protectedGetCallback(d),c._setLoaded(!0))}),this._observeSimplaBuffer(b)},_observeSimplaBuffer:function(b){var c=this,d=this.__simplaObservers;b&&(d.buffer&&d.buffer.unobserve(),d.buffer=Simpla.observe(b,function(a){a&&a.data&&c._protectedGetCallback(a)}))},_updateSimplaBuffer:function(){var b=this;return h.reduce(function(c,d){return _extends(c,_defineProperty({},d,b[d]))},{})},_updateFromSimpla:function(a){_extends(this,a.data)},_protectedGetCallback:function(a){this.__loadingFromSimpla=!0,this[f](a),this.__loadingFromSimpla=!1},_protectedSetCallback:function(){if(!this.__loadingFromSimpla&&this._attached&&this.path){var b=this[g]();void 0===b&&null!==b||Simpla.set(this.path,{type:d,data:b})}},_syncedPropertiesObserver:function(){this.loaded&&this._protectedSetCallback()},_observeSimplaEditable:function(){var a=this,b=this.__simplaObservers;b.editable&&b.editable.unobserve(),b.editable=Simpla.observeState("editable",function(b){a.readonly||(a.editable=b)})}}};</script></head><body></body></html>